
<div class="text-center">

	<p> chat/text editor page! {{ message }} </p>
  <style> .hide { display:none;} </style>
  <p class="hide" id="file">{{file}}</p>
  <p class="hide" id="userRepo">{{userRepo}}</p>
  <p class="hide" id="gitUsername">{{gitUsername}}</p>

</div>

<div class="row">
    <div class="col-lg-6">
      <ul class="pages">
        <li class="chat page">
          <div class="chatArea">
            <ul class="messages"> <p> Chat here </p></ul>
          </div>
          <input class="inputMessage" placeholder="Type here..."/>
        </li>
        <li class="login page">
          <div class="form">
            <h3 class="title">What's your nickname?</h3>
            <input class="usernameInput" type="text" maxlength="14" />
          </div>
        </li>
      </ul>
    </div>
    <div class="col-lg-6">
      <div>
        <strong><p id="pushedFile"></p></strong>&nbsp;&nbsp;<button type="button" id="pushFile">push File!</button>
      </div>
      
        <pre class="pages" id="editor"></pre>

      </div>
    </div>
  </div>


  <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>
  <script src="../src-noconflict/ace.js" type="text/javascript" charset="utf-8"></script>
   <script src="../main.js"></script>

  <script>
  var Range    = ace.require("ace/range").Range;
  var editor     = ace.edit("editor");
  var code = editor.getValue();  
  var session  = editor.getSession();
  var length = editor.session.getLength();
  console.log(length);
  editor.moveCursorTo(length, 0-8);
  var cursor = editor.selection.getCursor();
  console.log(cursor);
   
  console.log(cursor.row);
  console.log(cursor.column);
     
  //var range = new Range(4, 0, 30, 0);
  var range = new Range();

   //add anchors to range
  range.start  = session.doc.createAnchor(range.start);
  range.end    = session.doc.createAnchor(range.end);
  range.end.$insertRight = true;

  if (cursor.row == length - 1) {
    range = new Range(length-26, 0-8,(length-26) + 25, 0-8);
  } else {
    range = new Range(1, 0, 1, 0);
  }

  /* range needs to be calculated based onCursor positions */
  //editor.getSession().getSelection().selectionLead.setPosition(2,3);

  var markerId = session.addMarker(range, "readonly-highlight");
    
  /* sets mode mode should be determined via file pulled from github */
  session.setMode("ace/mode/javascript");
  editor.setTheme("ace/theme/chaos");

  editor.selection.moveCursorToPosition({row: 3, column: 0});
  console.log(editor.selection.selectLine());
    
//customized key handler function
  editor.keyBinding.addKeyboardHandler({
      handleKeyboard : function(data, hash, keyString, keyCode, event) {
          if (hash === -1 || (keyCode <= 40 && keyCode >= 37)) return false;
          
          if (intersects(range)) {
              return {command:"null", passEvent:false};
          }
      }
  });
  
  //prevents copy/paste injection
  before(editor, 'onPaste', preventReadonly);
  before(editor, 'onCut',   preventReadonly);
  
  function before(obj, method, wrapper) {
      var orig = obj[method];
      obj[method] = function() {
          var args = Array.prototype.slice.call(arguments);
          return wrapper.call(this, function(){
              return orig.apply(obj, args);
          }, args);
      }
      return obj[method];
  }
  
  function intersects(range) {
      return editor.getSelectionRange().intersects(range);
  }
  
  function preventReadonly(next, args) {
      if (intersects(range)) return;
      next();
  };
  </script>

